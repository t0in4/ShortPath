in master branch was many repeated chunk of code
so, after code review i made some changes

